(function(e,n){function b(){if(!(this instanceof b))return new b;this.__toStore__=function(a){return a};this.__fromStore__=function(a){return a}}var g=e.collections;if(!(collections&&collections.Map&&collections.HashMap))throw Error("Map liberary is required");var l=g.Map,p=g.HashMap,d=e.localStorage;b.isSupported=d!==n;b.turnSessionMode=function(){d=e.sessionStorage};b.turnLocalMode=function(){d=e.localStorage};b.saveItem=function(a,h){d.setItem(a,h)};b.getItem=function(a){return d.getItem(a)};b.hasItem=
function(a){return!!d.getItem(a)};b.delItem=function(a){d.removeItem(a)};b.delItems=function(a){var h=!1,b;for(b in d){try{h=a(b,d[b])}catch(c){h=!1}h&&d.removeItem(b)}};b.clear=function(){d.clear()};b.toJSON=function(a){return e.JSON.stringify(a)};b.fromJSON=function(a){return e.JSON.parse(a)};b.isJSONFormat=function(a){try{return e.JSON.parse(a),!0}catch(b){return!1}};b.create=function(){return new b};b.prototype.defineToStore=function(a){this.__toStore__=a};b.prototype.defineFromStore=function(a){this.__fromStore__=
a};b.prototype.saveItems=function(a){if(!(a instanceof l))throw new TypeError("not a Map instance");a=a.entrySet().iterator();for(var b,f;a.hasNext();)b=a.next(),f=b.getKey(),b=this.__toStore__(b.getValue()),d.setItem(f,b)};b.prototype.getItems=function(a){var b=new p,f=!1,c;for(c in d)if(a){try{f=a(c,d[c])}catch(e){f=!1}f&&b.put(c,this.__fromStore__(d[c]))}else b.put(c,d[c]);return b};var m=function(a){var b="$"+ +new Date,c=function(a){for(var d=[b],e=[[]],g=a.entrySet().iterator(),k;g.hasNext();)k=
g.next(),d.push(k.getKey()),e.push(k.getValue());return(new Function(d,c.$)).apply(a,e).join("")};c.$=b+".push('"+a.replace(/\\/g,"\\\\").replace(/[\r\t\n]/g," ").split("<#").join("\t").replace(/((^|#>)[^\t]*)'/g,"$1\r").replace(/\t=(.*?)#>/g,"',$1,'").split("\t").join("');").split("#>").join(b+".push('").split("\r").join("\\'")+"');return "+b;return c},c=function(){if(!(this instanceof c))return new c};c.__cache__={};c.create=function(){return new c};c.prototype.read=function(a){var b=!/\s/.test(a),
d=c.__cache__;this.__fn__=b?d[a]||(d[a]=m(document.getElementById(a).innerHTML)):m(a);return this};c.prototype.compile=function(a){if(!(a instanceof l))throw new TypeError("not a Map instance");this.__html__=this.__fn__(a);return this};c.prototype.getHtml=function(){return this.__html__};c.prototype.render=function(a){document.getElementById(a).innerHTML=this.__html__};e.Template=c;e.Storage=b})(window);
